// Copyright 2002-2007.  Adobe Systems, Incorporated.  All rights reserved.// Crop and rotate the active document.// enable double clicking from the Macintosh Finder or the Windows Explorer#target photoshop// in case we double clicked the fileapp.bringToFront();// debug level: 0-2 (0:disable, 1:break on error, 2:break at beginning)// $.level = 0;// debugger; // launch debugger on next line/*main();function main(){    //declare listFile variable, prompt to browse for text file    var listFile = File.openDialog("Open List File","text(*.txt):*.txt;");     //if no file selected, return    if(listFile == null) return;    //read the selected text file (listFile) to a string(listString)    listFile.open('r') ;     var listString = listFile.read();     listFile.close();     //splitting at line breaks, convert into array of strings    fileList = listString.split('\n');    //iterate array of strings (filenames), open & save as tiff    for(var i=0; i<=fileList.length; i++){        var theFile =new File(fileList[i]);        app.open(theFile);        saveAsTiff(theFile);    }};function saveAsTiff(theFile){    //tiff saving options here}if (!app.documents.length > 0) {    // open sample file if no document is opened.	var strSamplesFolderDirectory = localize( "$$$/LocalizedFilenames.xml/SourceDirectoryName/id/Extras/[LOCALE]/[LOCALE]_Samples/value=Samples" );	var strSampleFileNameLayerComps = localize ("$$$/LocalizedFilenames.xml/SourceFileName/id/Extras/[LOCALE]/[LOCALE]_Samples/Layer_Comps.psd/value=Layer Comps.psd");	var fileName = app.path.toString() + "/" + strSamplesFolderDirectory + "/" + strSampleFileNameLayerComps;		var docRef = open( File(fileName) );}*/main()function main(){    try {        /*        var root = "~/Dev/Projects/baby-flashcard-app/photoshop/workingtest/";        var csvPath = root + "resizedefs.csv";        var listFile = new File(csvPath);        listFile.open('r') ;         var listString = listFile.read();         listFile.close();         //splitting at line breaks, convert into array of strings        targets = listString.split('\n');        //iterate array of strings (filenames), open & save as tiff        for(var i=0; i<=targets.length; i++){                        var vals = targets[i].split(',')                        var theFile =new File(fileList[i]);            app.open(theFile);            saveAsTiff(theFile);        }*/                //var listFile = File.openDialog("Open List File","jpeg(*.jpg):*.jpg;");         var filePath = "~/Dev/Projects/baby-flashcard-app/photoshop/workingtest/originals/donkey1.jpg"        var file = new File(filePath);        var doc = app.open(file);                var cropPcs = [0.4, 0.2, 0.8, 0.5]                    var resolution = app.activeDocument.resolution;        var docWidth = (1.0 * app.activeDocument.width * resolution) / 72.0; // decimal inches assuming 72 dpi (used in docRatio)        var docHeight = (1.0 * app.activeDocument.height * resolution) / 72.0; // ditto                /*        var bounds = [ docWidth.as('px') * cropPcs[0], docHeight.as('px') * cropPcs[1], docWidth.as('px') * cropPcs[2], docHeight.as('px') * cropPcs[3] ]        bounds = [Math.floor(bounds[0]), Math.floor(bounds[1]), Math.floor(bounds[2]), Math.floor(bounds[3]) ]         */        app.preferences.rulerUnits = Units.PIXELS;                 var bounds = [6860,2246,13720,5616];        doc.crop(bounds)        return;        var targetWidth = 2048;        docRatio = docWidth / docHeight; // decimal ratio of original width/height        var targetHeight = ((1.0 * targetWidth) / docRatio); // decimal calc        ResizeTheImage (targetWidth, targetHeight)        /*        var bounds = [ targetWidth * cropPcs[0],  targetHeight * cropPcs[1],  targetWidth * cropPcs[2], targetHeight * cropPcs[3] ]        bounds = [Math.floor(bounds[0]), Math.floor(bounds[1]), Math.floor(bounds[2]), Math.floor(bounds[3]) ]         app.preferences.rulerUnits = Units.PIXELS;                doc.crop(bounds)       */                 var newDest = "~/Dev/Projects/baby-flashcard-app/photoshop/workingtest/targets/ipad/donkey1_ipad.jpg"        var saveFile = new File(newDest, 'w')        SaveJPEG (saveFile, 2)                doc.close (SaveOptions.DONOTSAVECHANGES)    }    catch(ex){        console.log(ex)    }}function processCsvLine(line){        var vals = line.split(',')        var filePath = "~/Dev/Projects/baby-flashcard-app/photoshop/workingtest/originals/" + vals[0];    var file = new File(filePath);    var doc = app.open(file);             var resolution = app.activeDocument.resolution;    var docWidth = (1.0 * app.activeDocument.width * resolution) / 72.0; // decimal inches assuming 72 dpi (used in docRatio)    var docHeight = (1.0 * app.activeDocument.height * resolution) / 72.0; // ditto            var maxDim = Number(vals[2])    var targetWidth, targetHeight    if(docWidth > docHeight){        targetWidth = maxDim;            } else {            }            docRatio = docWidth / docHeight; // decimal ratio of original width/height    var targetHeight = ((1.0 * targetWidth) / docRatio); // decimal calc    ResizeTheImage (targetWidth, targetHeight)        var cropPcs = [ Number(vals[3]) , Number(vals[4]) , Number(vals[5]) ,Number(vals[6]) ]       var bounds = [ targetWidth * cropPcs[0],  targetHeight * cropPcs[1],  targetWidth * cropPcs[2], targetHeight * cropPcs[3] ]    bounds = [Math.floor(bounds[0]), Math.floor(bounds[1]), Math.floor(bounds[2]), Math.floor(bounds[3]) ]     app.preferences.rulerUnits = Units.PIXELS;            doc.crop(bounds)                var newDest = "~/Dev/Projects/baby-flashcard-app/photoshop/workingtest/targets/ipad/" + vals[1]    var saveFile = new File(newDest, 'w')    SaveJPEG (saveFile, 2)        doc.close (SaveOptions.DONOTSAVECHANGES)            }function SaveJPEG(saveFile, jpegQuality) {jpgSaveOptions = new JPEGSaveOptions();jpgSaveOptions.embedColorProfile = true;jpgSaveOptions.formatOptions = FormatOptions.STANDARDBASELINE;jpgSaveOptions.matte = MatteType.NONE;jpgSaveOptions.quality = jpegQuality; //1-12activeDocument.saveAs(saveFile, jpgSaveOptions, true,Extension.LOWERCASE);}function ResizeTheImage(width, height) {	var oldPref = app.preferences.rulerUnits;	var docWidth;	var docHeight;	var docRatio;	var newWidth;	var newHeight;	var resolution = app.activeDocument.resolution;	var limit = false; //sizeInfo.limit;    app.preferences.rulerUnits = Units.PIXELS; // save old preferences	// original width, height	docWidth = (1.0 * app.activeDocument.width * resolution) / 72.0; // decimal inches assuming 72 dpi (used in docRatio)	docHeight = (1.0 * app.activeDocument.height * resolution) / 72.0; // ditto	if (docWidth < 1.0 || docHeight < 1.0)		return true; // error	if (width < 1 || height < 1)		return true; // error	if ( limit && ( app.activeDocument.width.as('px') <= width && app.activeDocument.height.as('px') <= height ) ){		app.preferences.rulerUnits = oldPref; // restore old prefs		isCancelled = false; // if get here, definitely executed		return false; // no error	}	docRatio = docWidth / docHeight; // decimal ratio of original width/height	newWidth = width;	newHeight = ((1.0 * width) / docRatio); // decimal calc	if (newHeight > height) {		newWidth = docRatio * height; // decimal calc		newHeight = height;	}    // resize the image using a good conversion method while keeping the pixel resolution    // and the aspect ratio the same    app.activeDocument.resizeImage(newWidth, newHeight, resolution, ResampleMethod.BICUBIC);    app.preferences.rulerUnits = oldPref; // restore old prefs	isCancelled = false; // if get here, definitely executed	return false; // no error}// crop a 10 pixel border from the image//bounds = new Array(10, 10, app.activeDocument.width - 10, app.activeDocument.height - 10);//app.activeDocument.rotateCanvas(45);//app.activeDocument.crop(bounds);//bounds = null;